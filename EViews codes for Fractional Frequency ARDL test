matrix(5,2) mout
series y=gi
series x1=cpu
series x2=epu
series x3=gpr
series x4=eui

series trend=@trend+1

matrix(40,2) maic
matrix(40,1) mcof
scalar nn1=0
scalar aic0=-10000
For !kk=0.1 to 4 step 0.1
scalar no=@obs(y)
series sint=@sin(2*3.141592*trend*!kk/no)
series cost=@cos(2*3.141592*trend*!kk/no)
equation eq0.ls y y(-1) x1 x1(-1) x2 x2(-1) x3 x3(-1) x4 x4(-1) c sint cost
scalar aic1=eq0.@aic
scalar nn1=nn1+1
mcof(nn1,1)=eq0.@coefs(1)
maic(nn1,1)=eq0.@aic
maic(nn1,2)=!kk
	if aic1>aic0 then
	scalar kk0=!kk
	scalar aic0=eq0.@aic
endif
next

series sint0=@sin(2*3.141592*@trend*kk0/no)
series cost0=@cos(2*3.141592*@trend*kk0/no)
